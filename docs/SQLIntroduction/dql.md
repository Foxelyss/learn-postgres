---
title: DQL
nav_order: 3
layout: default
parent: Введение в SQL
---
# Data Query Language - Язык запросов 

Имеет в себе одну команду - `select`

И операторы:
1. from - указывается из какой таблицы будут копироваться данные в результирующую
2. where - условие для вывода информации
3. group by - группировка данных(создание временной таблицы, по столбцам из выборки)
4. having - условия для вывода информации, для сгруппированных данных
5. order by - сортировка выводныз данныз

## `select`

Как работает?

Создаёт временную таблицу и выводит данные(переносит из таблицы указанной в from)
```
select операнд1, операнд2
```
Операнд - ИДС, значение, агрегированная функция, подзапрос и т.д.

 ```sql
 select 1234+123,'Фырк'
 ```

Действия(спец. символы, слова..)

1. `*` позволяет выбрать все столбцы из таблицы
```sql
select * from students
```
1. Математические действия(как в `set`)
```sql
select age * 2 from students
```
1. `as` позволяет присваивать новые ИНДФ(операторы присваивания)
```sql
select name as "Имя студента" from students
```
1. `.` позволяет уточнить из какой таблицы берётся столбец
```sql
select students.name from students
```
1. Добавление символьных значений
```sql
select students.name || " Почему бы и нет?" from students
```
1. `distinct` - строковый оператор позволяющий не выводить повторяющиеся строки/значения
```sql
select distinct students.name from students
-- Не выведет два Ивана!
```
1. Агрегированные функции - короткая запись, которая вызывает какие-либо действия над данными<br>Общий вид:
```sql
select название_ф-ии(ИДТ) from ИДС
```
Пример:
```sql
select min(age) from students
```
Функции

| Название | Описание                                                              |
| -------- | --------------------------------------------------------------------- |
| sum      | Сумма всех значений столбца                                           |
| avg      | Среднее всех значений столбца                                         |
| min      | Минимум всех значений столбца                                         |
| max      | Максимум всех значений столбца                                        |
| count    | Количество записей                                                    |
| extract  | Извлечение значения из каскада, также например из даты месяца, и т.п. |
| concat   | Объединение двух столбцов с образованием каскада                      |

Виды агрегированных функций:
1. По столбцам(arg, sum, min, max...)
2. По строкам(concat, count, extract)

По работе с типами данных:
1. С числовыми(arg, sum....)
2. С символьными типами(extract)
3. С любыми(min, max, count, concat)

Пример extract:
```sql
select extract(year from students.birthdate) from students
```

## Операторы

### `from`

Действия во from
1. Объявлять временные связи

| Действие        | Описание                                                                            |
| --------------- | ----------------------------------------------------------------------------------- |
| inner join      | объединяет значения по одинаковым атрибутам в таблицах                              |
| left join       | Объединяет таблицы по одинаковым атрибуам в таблицах + все данные из левой таблицы  |
| right join      | Объединяет таблицы по одинаковым атрибуам в таблицах + все данные из правой таблицы |
| full join(join) | Объединяет таблицы полностью                                                        |

Общий вид:
```sql
from ИДТ inner/left/right/full 
join ИДТ2 on ИДТ1.ИДС=ИДТ2.ИДС
```

Для 3 и более
```sql
from ИДТ inner/left/right/full 
(inner/left/right/full join ИДТ2 on ИДТ2.ИДС=ИДТ3.ИДС) 
join ИДТ2 on ИДТ1.ИДС=ИДТ2.ИДС
```

Примеры:
```sql
select * from students
inner join grades.stud_id = students.id
```

```sql
select * from teachers 
(select * from students
right join grades.stud_id = students.id) 
inner join teachers.id = grades.teacher_id
```

{:style="counter-reset:step-counter 1"}
2. Подзапрос

```sql
(select * from students
right join grades.stud_id = students.id) 
```
Можно использовать в агрегир-ых ф-ях
```sql
select sum(select * from students
right join grades.stud_id = students.id) 
```
### `where` - оператор условия

Условие выполняется слево направо

### Подзапросы
### `group by`

### `having`

### `order by`


### `limit` - ограничение количества записей
```
limit N -- Где N количество записей
```

### `offset` - смещение ответа на несколько записей
```
offset N -- Где N количество записей которые будут пропущены
```
